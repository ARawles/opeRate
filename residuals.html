<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>14.3 Residuals | opeRate</title>
  <meta name="description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="14.3 Residuals | opeRate" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="cover.png" />
  <meta property="og:description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="github-repo" content="ARawles/opeRate" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="14.3 Residuals | opeRate" />
  
  <meta name="twitter:description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="twitter:image" content="cover.png" />

<meta name="author" content="Adam Rawles" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="coefficients.html"/>
<link rel="next" href="lm-function.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> opeRate</a>
<ul>
<li class="chapter" data-level="1.1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="about-me.html"><a href="about-me.html"><i class="fa fa-check"></i><b>1.2</b> About Me</a></li>
<li class="chapter" data-level="1.3" data-path="using-r.html"><a href="using-r.html"><i class="fa fa-check"></i><b>1.3</b> Using R</a></li>
</ul></li>
<li class="part"><span><b>I tidyverse</b></span></li>
<li class="chapter" data-level="2" data-path="tidyverse-introduction.html"><a href="tidyverse-introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>3</b> “Tidy” data</a></li>
<li class="chapter" data-level="4" data-path="the-pipe.html"><a href="the-pipe.html"><i class="fa fa-check"></i><b>4</b> The pipe (<code>%&gt;%</code>)</a></li>
<li class="chapter" data-level="5" data-path="quasiquotation.html"><a href="quasiquotation.html"><i class="fa fa-check"></i><b>5</b> Quasiquotation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tidyselect.html"><a href="tidyselect.html"><i class="fa fa-check"></i><b>5.1</b> tidyselect</a></li>
</ul></li>
<li class="part"><span><b>II Data Analysis</b></span></li>
<li class="chapter" data-level="6" data-path="da-intro.html"><a href="da-intro.html"><i class="fa fa-check"></i><b>6</b> Introduction</a></li>
<li class="chapter" data-level="7" data-path="loading.html"><a href="loading.html"><i class="fa fa-check"></i><b>7</b> Loading</a>
<ul>
<li class="chapter" data-level="7.1" data-path="rds.html"><a href="rds.html"><i class="fa fa-check"></i><b>7.1</b> RDS</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="rds.html"><a href="rds.html#advantages"><i class="fa fa-check"></i><b>7.1.1</b> Advantages</a></li>
<li class="chapter" data-level="7.1.2" data-path="rds.html"><a href="rds.html#disadvantages"><i class="fa fa-check"></i><b>7.1.2</b> Disadvantages</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="csv.html"><a href="csv.html"><i class="fa fa-check"></i><b>7.2</b> CSV</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="csv.html"><a href="csv.html#loading-csv-files"><i class="fa fa-check"></i><b>7.2.1</b> Loading CSV files</a></li>
<li class="chapter" data-level="7.2.2" data-path="csv.html"><a href="csv.html#advantages-1"><i class="fa fa-check"></i><b>7.2.2</b> Advantages</a></li>
<li class="chapter" data-level="7.2.3" data-path="csv.html"><a href="csv.html#disadvantages-1"><i class="fa fa-check"></i><b>7.2.3</b> Disadvantages</a></li>
<li class="chapter" data-level="7.2.4" data-path="csv.html"><a href="csv.html#other-delimited-files"><i class="fa fa-check"></i><b>7.2.4</b> Other delimited files</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="excel-files.html"><a href="excel-files.html"><i class="fa fa-check"></i><b>7.3</b> Excel files</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="excel-files.html"><a href="excel-files.html#advantages-2"><i class="fa fa-check"></i><b>7.3.1</b> Advantages</a></li>
<li class="chapter" data-level="7.3.2" data-path="excel-files.html"><a href="excel-files.html#disadvantages-2"><i class="fa fa-check"></i><b>7.3.2</b> Disadvantages</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="web-based-apis.html"><a href="web-based-apis.html"><i class="fa fa-check"></i><b>7.4</b> Web-based APIs</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="web-based-apis.html"><a href="web-based-apis.html#what-are-apis"><i class="fa fa-check"></i><b>7.4.1</b> What are APIs?</a></li>
<li class="chapter" data-level="7.4.2" data-path="web-based-apis.html"><a href="web-based-apis.html#accessing-apis-in-r"><i class="fa fa-check"></i><b>7.4.2</b> Accessing APIs in R</a></li>
<li class="chapter" data-level="7.4.3" data-path="web-based-apis.html"><a href="web-based-apis.html#bmrsr"><i class="fa fa-check"></i><b>7.4.3</b> BMRSr</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="databases.html"><a href="databases.html"><i class="fa fa-check"></i><b>7.5</b> Databases</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="databases.html"><a href="databases.html#database-management-systems-and-odbc"><i class="fa fa-check"></i><b>7.5.1</b> Database Management Systems and ODBC</a></li>
<li class="chapter" data-level="7.5.2" data-path="databases.html"><a href="databases.html#connecting-with-the-odbc-package"><i class="fa fa-check"></i><b>7.5.2</b> Connecting with the <code>odbc</code> package</a></li>
<li class="chapter" data-level="7.5.3" data-path="databases.html"><a href="databases.html#querying-the-database"><i class="fa fa-check"></i><b>7.5.3</b> Querying the database</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cleaning.html"><a href="cleaning.html"><i class="fa fa-check"></i><b>8</b> Cleaning</a>
<ul>
<li class="chapter" data-level="8.1" data-path="filtering.html"><a href="filtering.html"><i class="fa fa-check"></i><b>8.1</b> Filtering</a></li>
<li class="chapter" data-level="8.2" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>8.2</b> Missing values</a></li>
<li class="chapter" data-level="8.3" data-path="changing-column-types.html"><a href="changing-column-types.html"><i class="fa fa-check"></i><b>8.3</b> Changing column types</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tidying.html"><a href="tidying.html"><i class="fa fa-check"></i><b>9</b> Tidying</a>
<ul>
<li class="chapter" data-level="9.1" data-path="pivoting.html"><a href="pivoting.html"><i class="fa fa-check"></i><b>9.1</b> Pivoting</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="pivoting.html"><a href="pivoting.html#pivoting-columns-to-rows-longer"><i class="fa fa-check"></i><b>9.1.1</b> Pivoting columns to rows (longer)</a></li>
<li class="chapter" data-level="9.1.2" data-path="pivoting.html"><a href="pivoting.html#pivoting-rows-to-columns-wider"><i class="fa fa-check"></i><b>9.1.2</b> Pivoting rows to columns (wider)</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="separating-uniting.html"><a href="separating-uniting.html"><i class="fa fa-check"></i><b>9.2</b> Separating &amp; Uniting</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="separating-uniting.html"><a href="separating-uniting.html#separating"><i class="fa fa-check"></i><b>9.2.1</b> Separating</a></li>
<li class="chapter" data-level="9.2.2" data-path="separating-uniting.html"><a href="separating-uniting.html#uniting"><i class="fa fa-check"></i><b>9.2.2</b> Uniting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="grouping.html"><a href="grouping.html"><i class="fa fa-check"></i><b>10</b> Grouping</a></li>
<li class="chapter" data-level="11" data-path="mutating.html"><a href="mutating.html"><i class="fa fa-check"></i><b>11</b> Mutating</a></li>
<li class="chapter" data-level="12" data-path="summarising.html"><a href="summarising.html"><i class="fa fa-check"></i><b>12</b> Summarising</a></li>
<li class="chapter" data-level="13" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>13</b> Plotting</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>13.1</b> ggplot2</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="ggplot2.html"><a href="ggplot2.html#components"><i class="fa fa-check"></i><b>13.1.1</b> Components</a></li>
<li class="chapter" data-level="13.1.2" data-path="ggplot2.html"><a href="ggplot2.html#layers"><i class="fa fa-check"></i><b>13.1.2</b> Layers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="modelling.html"><a href="modelling.html"><i class="fa fa-check"></i><b>14</b> Modelling</a>
<ul>
<li class="chapter" data-level="14.1" data-path="types-of-model.html"><a href="types-of-model.html"><i class="fa fa-check"></i><b>14.1</b> Types of model</a></li>
<li class="chapter" data-level="14.2" data-path="coefficients.html"><a href="coefficients.html"><i class="fa fa-check"></i><b>14.2</b> Coefficients</a></li>
<li class="chapter" data-level="14.3" data-path="residuals.html"><a href="residuals.html"><i class="fa fa-check"></i><b>14.3</b> Residuals</a></li>
<li class="chapter" data-level="14.4" data-path="lm-function.html"><a href="lm-function.html"><i class="fa fa-check"></i><b>14.4</b> <code>lm()</code> function</a></li>
<li class="chapter" data-level="14.5" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i><b>14.5</b> Example</a></li>
<li class="chapter" data-level="14.6" data-path="evaluating-models.html"><a href="evaluating-models.html"><i class="fa fa-check"></i><b>14.6</b> Evaluating Models</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="evaluating-models.html"><a href="evaluating-models.html#residuals-1"><i class="fa fa-check"></i><b>14.6.1</b> Residuals</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Projects</b></span></li>
<li class="chapter" data-level="15" data-path="projects-introduction.html"><a href="projects-introduction.html"><i class="fa fa-check"></i><b>15</b> Introduction</a></li>
<li class="chapter" data-level="16" data-path="workflows.html"><a href="workflows.html"><i class="fa fa-check"></i><b>16</b> Workflows</a>
<ul>
<li class="chapter" data-level="16.1" data-path="basic-workflow.html"><a href="basic-workflow.html"><i class="fa fa-check"></i><b>16.1</b> Basic Workflow</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="basic-workflow.html"><a href="basic-workflow.html#example-1-reporting"><i class="fa fa-check"></i><b>16.1.1</b> Example 1: Reporting</a></li>
<li class="chapter" data-level="16.1.2" data-path="basic-workflow.html"><a href="basic-workflow.html#example-2-modelling"><i class="fa fa-check"></i><b>16.1.2</b> Example 2: Modelling</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="separating-stages.html"><a href="separating-stages.html"><i class="fa fa-check"></i><b>16.2</b> Separating Stages</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="separating-stages.html"><a href="separating-stages.html#functions"><i class="fa fa-check"></i><b>16.2.1</b> Functions</a></li>
<li class="chapter" data-level="16.2.2" data-path="separating-stages.html"><a href="separating-stages.html#files"><i class="fa fa-check"></i><b>16.2.2</b> Files</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>16.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="replicability.html"><a href="replicability.html"><i class="fa fa-check"></i><b>17</b> Replicability</a>
<ul>
<li class="chapter" data-level="17.1" data-path="good-practice.html"><a href="good-practice.html"><i class="fa fa-check"></i><b>17.1</b> Good practice</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="good-practice.html"><a href="good-practice.html#use-a-consistent-naming-convention"><i class="fa fa-check"></i><b>17.1.1</b> Use a consistent naming convention</a></li>
<li class="chapter" data-level="17.1.2" data-path="good-practice.html"><a href="good-practice.html#name-your-variables-as-nouns-and-your-functions-as-verbs"><i class="fa fa-check"></i><b>17.1.2</b> Name your variables as nouns and your functions as verbs</a></li>
<li class="chapter" data-level="17.1.3" data-path="good-practice.html"><a href="good-practice.html#use-functions-where-you-can"><i class="fa fa-check"></i><b>17.1.3</b> Use functions where you can</a></li>
<li class="chapter" data-level="17.1.4" data-path="good-practice.html"><a href="good-practice.html#state-your-dependencies"><i class="fa fa-check"></i><b>17.1.4</b> State your dependencies</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="documentation.html"><a href="documentation.html"><i class="fa fa-check"></i><b>17.2</b> Documentation</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="documentation.html"><a href="documentation.html#function-documentation"><i class="fa fa-check"></i><b>17.2.1</b> Function documentation</a></li>
<li class="chapter" data-level="17.2.2" data-path="documentation.html"><a href="documentation.html#long-form-documentation"><i class="fa fa-check"></i><b>17.2.2</b> Long-form documentation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="projects-as-packages.html"><a href="projects-as-packages.html"><i class="fa fa-check"></i><b>18</b> Projects as Packages</a>
<ul>
<li class="chapter" data-level="18.1" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>18.1</b> Structure</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="structure.html"><a href="structure.html#r-code"><i class="fa fa-check"></i><b>18.1.1</b> R code</a></li>
<li class="chapter" data-level="18.1.2" data-path="structure.html"><a href="structure.html#data"><i class="fa fa-check"></i><b>18.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="documentation-1.html"><a href="documentation-1.html"><i class="fa fa-check"></i><b>18.2</b> Documentation</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="documentation-1.html"><a href="documentation-1.html#functional"><i class="fa fa-check"></i><b>18.2.1</b> Functional</a></li>
<li class="chapter" data-level="18.2.2" data-path="documentation-1.html"><a href="documentation-1.html#long-form"><i class="fa fa-check"></i><b>18.2.2</b> Long-form</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="description.html"><a href="description.html"><i class="fa fa-check"></i><b>18.3</b> DESCRIPTION</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="description.html"><a href="description.html#dependencies"><i class="fa fa-check"></i><b>18.3.1</b> Dependencies</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="abstraction.html"><a href="abstraction.html"><i class="fa fa-check"></i><b>18.4</b> Abstraction</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="git-github.html"><a href="git-github.html"><i class="fa fa-check"></i><b>19</b> Git &amp; GitHub</a></li>
<li class="chapter" data-level="20" data-path="project-example.html"><a href="project-example.html"><i class="fa fa-check"></i><b>20</b> Project Example</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">opeRate</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="residuals" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> Residuals</h2>
<p>When we create a model, there will be a difference between the model’s predicted value and each data point. These are the <strong>model residuals</strong>. The smaller the total residual difference, the more accurate the model is. Let’s visualise how we would calculate our residuals:</p>
<p><img src="opeRate_files/figure-html/unnamed-chunk-72-1.png" width="672" /><img src="opeRate_files/figure-html/unnamed-chunk-72-2.png" width="672" /></p>
<p>To compare different models though, we need to boil down this residuals into a single metric. For this we use the root-mean-square-error or RMSE. The calculation for this metric is quite easy - calculate the difference, square it, average it and then take the root. Let’s write some functions to produce some models and get some predictions, and then compare the RMSE:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="residuals.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some models with different coefficients</span></span>
<span id="cb121-2"><a href="residuals.html#cb121-2" aria-hidden="true" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb121-3"><a href="residuals.html#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb121-4"><a href="residuals.html#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">a =</span> <span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="dv">35</span>, <span class="at">max =</span> <span class="dv">40</span>),</span>
<span id="cb121-5"><a href="residuals.html#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">a1 =</span> <span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">max =</span> <span class="sc">-</span><span class="dv">5</span>)</span>
<span id="cb121-6"><a href="residuals.html#cb121-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-7"><a href="residuals.html#cb121-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-8"><a href="residuals.html#cb121-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-9"><a href="residuals.html#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the models</span></span>
<span id="cb121-10"><a href="residuals.html#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb121-11"><a href="residuals.html#cb121-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb121-12"><a href="residuals.html#cb121-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> coefficients, <span class="fu">aes</span>(<span class="at">intercept =</span> a, <span class="at">slope =</span> a1, <span class="at">colour =</span> <span class="fu">as.factor</span>(id)), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb121-13"><a href="residuals.html#cb121-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Model&quot;</span>)</span></code></pre></div>
<p><img src="opeRate_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="residuals.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to represent our model</span></span>
<span id="cb122-2"><a href="residuals.html#cb122-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(a, a1, wt) {</span>
<span id="cb122-3"><a href="residuals.html#cb122-3" aria-hidden="true" tabindex="-1"></a>  a <span class="sc">+</span> (wt <span class="sc">*</span> a1)</span>
<span id="cb122-4"><a href="residuals.html#cb122-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb122-5"><a href="residuals.html#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="residuals.html#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="co"># A function to work out the rmse of our model</span></span>
<span id="cb122-7"><a href="residuals.html#cb122-7" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(a, a1, wt, mpg) {</span>
<span id="cb122-8"><a href="residuals.html#cb122-8" aria-hidden="true" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> <span class="fu">model</span>(a, a1, wt) <span class="sc">-</span> mpg</span>
<span id="cb122-9"><a href="residuals.html#cb122-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">mean</span>(diff <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb122-10"><a href="residuals.html#cb122-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we now how to calculate our RMSE, let’s apply calculate which of our models has the lowest error:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="residuals.html#cb123-1" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> coefficients <span class="sc">%&gt;%</span></span>
<span id="cb123-2"><a href="residuals.html#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Here we calculate the rmse of each model</span></span>
<span id="cb123-3"><a href="residuals.html#cb123-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">rmse =</span> <span class="fu">unlist</span>(purrr<span class="sc">::</span><span class="fu">map2</span>(a, a1, rmse, <span class="at">wt =</span> mtcars<span class="sc">$</span>wt, <span class="at">mpg =</span> mtcars<span class="sc">$</span>mpg))) <span class="sc">%&gt;%</span></span>
<span id="cb123-4"><a href="residuals.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(rmse <span class="sc">==</span> <span class="fu">min</span>(rmse))</span>
<span id="cb123-5"><a href="residuals.html#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(best_model)</span></code></pre></div>
<pre><code>##   id        a        a1     rmse
## 1 10 37.46765 -5.350819 2.953621</code></pre>
<p>According to our analysis, model 10 has the lowest residual error. Let’s see what that model looks like:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="residuals.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb125-2"><a href="residuals.html#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb125-3"><a href="residuals.html#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> best_model, <span class="fu">aes</span>(<span class="at">intercept =</span> a, <span class="at">slope =</span> a1, <span class="at">colour =</span> <span class="fu">as.factor</span>(id)), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb125-4"><a href="residuals.html#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Model&quot;</span>)</span></code></pre></div>
<p><img src="opeRate_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<p>That looks pretty good, but it’s not perfect. We’ve just tried a number of different values and then chosen the best one. This doesn’t mean that we’ve found the absolute best coefficients for our model. In reality, we’d need to work out the best values by <strong>optimising</strong> our RMSE function - finding the values that produce the global minimum value from that function.</p>
<p>We’re not going to bother doing that manually, but that’s essentially the process that the <code>lm()</code> function in R uses; it automatically finds the best coefficient values by calculating the RMSE for lots of different values and then finding the best one.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="coefficients.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lm-function.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
