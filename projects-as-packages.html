<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.3 Projects as Packages | opeRate</title>
  <meta name="description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3.3 Projects as Packages | opeRate" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="cover.png" />
  <meta property="og:description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="github-repo" content="ARawles/opeRate" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.3 Projects as Packages | opeRate" />
  
  <meta name="twitter:description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="twitter:image" content="cover.png" />

<meta name="author" content="Adam Rawles" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="replicability.html"/>
<link rel="next" href="data-analysis.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> opeRate</a>
<ul>
<li class="chapter" data-level="1.1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>1.1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="overview.html"><a href="overview.html#acknowledgements"><i class="fa fa-check"></i><b>1.1.1</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="about-me.html"><a href="about-me.html"><i class="fa fa-check"></i><b>1.2</b> About Me</a></li>
<li class="chapter" data-level="1.3" data-path="using-r.html"><a href="using-r.html"><i class="fa fa-check"></i><b>1.3</b> Using R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>2</b> tidyverse</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>2.1</b> “Tidy” data</a></li>
<li class="chapter" data-level="2.2" data-path="the-pipe.html"><a href="the-pipe.html"><i class="fa fa-check"></i><b>2.2</b> The pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="2.3" data-path="quasiquotation.html"><a href="quasiquotation.html"><i class="fa fa-check"></i><b>2.3</b> Quasiquotation</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="quasiquotation.html"><a href="quasiquotation.html#tidyselect"><i class="fa fa-check"></i><b>2.3.1</b> tidyselect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="projects.html"><a href="projects.html"><i class="fa fa-check"></i><b>3</b> Projects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="workflows.html"><a href="workflows.html"><i class="fa fa-check"></i><b>3.1</b> Workflows</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="workflows.html"><a href="workflows.html#basic-workflow"><i class="fa fa-check"></i><b>3.1.1</b> Basic Workflow</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="replicability.html"><a href="replicability.html"><i class="fa fa-check"></i><b>3.2</b> Replicability</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="replicability.html"><a href="replicability.html#good-practice"><i class="fa fa-check"></i><b>3.2.1</b> Good practice</a></li>
<li class="chapter" data-level="3.2.2" data-path="replicability.html"><a href="replicability.html#documentation"><i class="fa fa-check"></i><b>3.2.2</b> Documentation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="projects-as-packages.html"><a href="projects-as-packages.html"><i class="fa fa-check"></i><b>3.3</b> Projects as Packages</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="projects-as-packages.html"><a href="projects-as-packages.html#structure"><i class="fa fa-check"></i><b>3.3.1</b> Structure</a></li>
<li class="chapter" data-level="3.3.2" data-path="projects-as-packages.html"><a href="projects-as-packages.html#documentation-1"><i class="fa fa-check"></i><b>3.3.2</b> Documentation</a></li>
<li class="chapter" data-level="3.3.3" data-path="projects-as-packages.html"><a href="projects-as-packages.html#description"><i class="fa fa-check"></i><b>3.3.3</b> DESCRIPTION</a></li>
<li class="chapter" data-level="3.3.4" data-path="projects-as-packages.html"><a href="projects-as-packages.html#abstraction"><i class="fa fa-check"></i><b>3.3.4</b> Abstraction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>4</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="loading.html"><a href="loading.html"><i class="fa fa-check"></i><b>4.1</b> Loading</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="loading.html"><a href="loading.html#csv"><i class="fa fa-check"></i><b>4.1.1</b> csv</a></li>
<li class="chapter" data-level="4.1.2" data-path="loading.html"><a href="loading.html#excel-files"><i class="fa fa-check"></i><b>4.1.2</b> Excel files</a></li>
<li class="chapter" data-level="4.1.3" data-path="loading.html"><a href="loading.html#using-apis"><i class="fa fa-check"></i><b>4.1.3</b> Using APIs</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="cleaning.html"><a href="cleaning.html"><i class="fa fa-check"></i><b>4.2</b> Cleaning</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="cleaning.html"><a href="cleaning.html#missing-values"><i class="fa fa-check"></i><b>4.2.1</b> Missing values</a></li>
<li class="chapter" data-level="4.2.2" data-path="cleaning.html"><a href="cleaning.html#changing-column-types"><i class="fa fa-check"></i><b>4.2.2</b> Changing column types</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tidying.html"><a href="tidying.html"><i class="fa fa-check"></i><b>4.3</b> Tidying</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="tidying.html"><a href="tidying.html#pivoting-columns"><i class="fa fa-check"></i><b>4.3.1</b> Pivoting columns</a></li>
<li class="chapter" data-level="4.3.2" data-path="tidying.html"><a href="tidying.html#pivoting-columns-to-rows-longer"><i class="fa fa-check"></i><b>4.3.2</b> Pivoting columns to rows (longer)</a></li>
<li class="chapter" data-level="4.3.3" data-path="tidying.html"><a href="tidying.html#pivoting-rows-to-columns-wider"><i class="fa fa-check"></i><b>4.3.3</b> Pivoting rows to columns (wider)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="grouping.html"><a href="grouping.html"><i class="fa fa-check"></i><b>4.4</b> Grouping</a></li>
<li class="chapter" data-level="4.5" data-path="mutating.html"><a href="mutating.html"><i class="fa fa-check"></i><b>4.5</b> Mutating</a></li>
<li class="chapter" data-level="4.6" data-path="summarising.html"><a href="summarising.html"><i class="fa fa-check"></i><b>4.6</b> Summarising</a></li>
<li class="chapter" data-level="4.7" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>4.7</b> Plotting</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">opeRate</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="projects-as-packages" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Projects as Packages</h2>
<p>To make a good, replicable and easy to understand project, you need a few things:</p>
<ol style="list-style-type: decimal">
<li>A clear structure</li>
<li>Easily replicable code (e.g. consistent functions and clear dependencies)</li>
<li>Good documentation (functional and long-form)</li>
<li>Maybe a test or two if you want to be confident in your functions and findings</li>
</ol>
<p>While you could easily fulfill all of these criteria with a standard RStudio project, there’s already a type of project that conforms to these standards: <em>Packages</em>.</p>
<p>While packages are primarily meant for collating and distributing new functionality, we can utilise the package structure and some of the tools that come along with package development to make our project easier to understand.</p>
<p>To better understand what a package is and how they are developed and maintained, I would recommend reading Hadley and Jenny Bryan’s <a href="https://r-pkgs.org/">R Packages book</a> book. Although that book is focused directly on developing packages for submission to CRAN, hopefully you’ll be able to identify the parts that are going to be applicable to the way we’re using packages.</p>
<div id="structure" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Structure</h3>
<div id="r-code" class="section level4" number="3.3.1.1">
<h4><span class="header-section-number">3.3.1.1</span> R code</h4>
<p>The structure of R files in a package is pretty simple. Everything goes in the root of the R folder. That means no subfolders. There are also some filenames that should be avoided for normal packages, but we won’t worry too much about that for now.</p>
<p>When you then run the <code>devtools::load_all()</code> command, <code>{devtools}</code> checks that you’ve got the dependencies listed in the DESCRIPTION file loaded and then loads all of the files in the R folder are then loaded. This means you can make quick changes to your code and then run <code>devtools::load_all()</code> to bring those changes into your current environment. This helps prevent working on data or functions that are out of date (which often happens when you’re manually sourcing R files).</p>
</div>
<div id="data" class="section level4" number="3.3.1.2">
<h4><span class="header-section-number">3.3.1.2</span> Data</h4>
<p>For some projects, you’ll want to include a static dataset or datasets that you’re basing your analysis on. Packages also have a way of including data in a standard way. Use the <code>usethis::use_data()</code> function to bundle an R object with your package. You can make sure that the data needed for your project is included with it.</p>
<p>For other projects, you’ll want to use the latest data whenever the analysis is done. For this, I would recommend creating a set of functions to get your data and including those in the package. That will ensure that getting the data needed for your analysis is as simple as possible for people reading your code.</p>
</div>
</div>
<div id="documentation-1" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Documentation</h3>
<div id="functional" class="section level4" number="3.3.2.1">
<h4><span class="header-section-number">3.3.2.1</span> Functional</h4>
<p>To document your functions, I would highly recommend the <code>roxygen</code> package. It’s by far the easiest way to document your functions. Once you’ve documentated your functions, you can run <code>devtools::document()</code> to automatically generate the documentation that will be seen when someone visits the help page for your function (e.g. via <code>?your_function</code>).</p>
</div>
<div id="long-form" class="section level4" number="3.3.2.2">
<h4><span class="header-section-number">3.3.2.2</span> Long-form</h4>
<p>For your long-form documentation, the <code>usethis::use_readme()</code> function will provide you with a template for you to build your README.</p>
<p>For vignettes, the <code>usethis::use_vignette()</code> function will create the appropriate file and folder for you, so you can just focus on writing.</p>
</div>
</div>
<div id="description" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> DESCRIPTION</h3>
<p>Every package you download will have a DESCRIPTION file. This file has a number of fields, like who the author is, what license the content is under, and so on. We can utilize many of the fields to help document our project. For example, the Description and Title field are just as relevant for a package-project. Equally, we can use the Version field to keep track of different iterations of our analysis. We can also use this file to state our dependencies.</p>
<div id="dependencies" class="section level4" number="3.3.3.1">
<h4><span class="header-section-number">3.3.3.1</span> Dependencies</h4>
<p>Every package will have an entry called Imports in its DESCRIPTION file. Here, the author is stating every other package that’s needed for this package to run. So we can use that same field to state all of the packages that are required for our analysis. That way, when someone installs our package to replicate or check our analysis, all the appropriate dependencies can be installed at the same time.</p>
</div>
</div>
<div id="abstraction" class="section level3" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Abstraction</h3>
<p>When I was younger, I wrote a package to create a kind of financial stability report. The report essentially used a number of APIs to pull in macroeconomic data and then create an RMarkdown report displaying the data. Then, a few months later, I started another analysis that used very much the same kind of data but for a different purpose. Now, there were three things I could do:</p>
<ol style="list-style-type: decimal">
<li>Copy all the code used to get the API data from the original project into the new one</li>
<li>Put the original project as a dependency of the new project, importing all of the API data but also all of the other functions</li>
<li>Abstract the functions used to get the data from the original project into a new package, and then have both projects use that as dependency.</li>
</ol>
<p>Given that the title of this section is “Abstraction”, what do you think I went with?</p>
<p>Structuring your analysis in this way helps you re-use or repurpose code in the future without having to copy and paste or duplicate any of your previous work.</p>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="replicability.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
