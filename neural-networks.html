<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15.1 Neural networks | opeRate</title>
  <meta name="description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="15.1 Neural networks | opeRate" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="cover.png" />
  <meta property="og:description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="github-repo" content="ARawles/opeRate" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15.1 Neural networks | opeRate" />
  
  <meta name="twitter:description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="twitter:image" content="cover.png" />

<meta name="author" content="Adam Rawles" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="machine-learning.html"/>
<link rel="next" href="projects-introduction.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> opeRate</a>
<ul>
<li class="chapter" data-level="1.1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="about-me.html"><a href="about-me.html"><i class="fa fa-check"></i><b>1.2</b> About Me</a></li>
<li class="chapter" data-level="1.3" data-path="using-r.html"><a href="using-r.html"><i class="fa fa-check"></i><b>1.3</b> Using R</a></li>
</ul></li>
<li class="part"><span><b>I tidyverse</b></span></li>
<li class="chapter" data-level="2" data-path="tidyverse-introduction.html"><a href="tidyverse-introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>3</b> “Tidy” data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="questions.html"><a href="questions.html"><i class="fa fa-check"></i><b>3.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-pipe.html"><a href="the-pipe.html"><i class="fa fa-check"></i><b>4</b> The pipe (<code>%&gt;%</code>)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="questions-1.html"><a href="questions-1.html"><i class="fa fa-check"></i><b>4.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="quasiquotation.html"><a href="quasiquotation.html"><i class="fa fa-check"></i><b>5</b> Quasiquotation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tidyselect.html"><a href="tidyselect.html"><i class="fa fa-check"></i><b>5.1</b> tidyselect</a></li>
<li class="chapter" data-level="5.2" data-path="questions-2.html"><a href="questions-2.html"><i class="fa fa-check"></i><b>5.2</b> Questions</a></li>
</ul></li>
<li class="part"><span><b>II Data Analysis</b></span></li>
<li class="chapter" data-level="6" data-path="da-intro.html"><a href="da-intro.html"><i class="fa fa-check"></i><b>6</b> Introduction</a></li>
<li class="chapter" data-level="7" data-path="loading.html"><a href="loading.html"><i class="fa fa-check"></i><b>7</b> Loading</a>
<ul>
<li class="chapter" data-level="7.1" data-path="rds.html"><a href="rds.html"><i class="fa fa-check"></i><b>7.1</b> RDS</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="rds.html"><a href="rds.html#advantages"><i class="fa fa-check"></i><b>7.1.1</b> Advantages</a></li>
<li class="chapter" data-level="7.1.2" data-path="rds.html"><a href="rds.html#disadvantages"><i class="fa fa-check"></i><b>7.1.2</b> Disadvantages</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="csv.html"><a href="csv.html"><i class="fa fa-check"></i><b>7.2</b> CSV</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="csv.html"><a href="csv.html#loading-csv-files"><i class="fa fa-check"></i><b>7.2.1</b> Loading CSV files</a></li>
<li class="chapter" data-level="7.2.2" data-path="csv.html"><a href="csv.html#advantages-1"><i class="fa fa-check"></i><b>7.2.2</b> Advantages</a></li>
<li class="chapter" data-level="7.2.3" data-path="csv.html"><a href="csv.html#disadvantages-1"><i class="fa fa-check"></i><b>7.2.3</b> Disadvantages</a></li>
<li class="chapter" data-level="7.2.4" data-path="csv.html"><a href="csv.html#other-delimited-files"><i class="fa fa-check"></i><b>7.2.4</b> Other delimited files</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="excel-files.html"><a href="excel-files.html"><i class="fa fa-check"></i><b>7.3</b> Excel files</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="excel-files.html"><a href="excel-files.html#advantages-2"><i class="fa fa-check"></i><b>7.3.1</b> Advantages</a></li>
<li class="chapter" data-level="7.3.2" data-path="excel-files.html"><a href="excel-files.html#disadvantages-2"><i class="fa fa-check"></i><b>7.3.2</b> Disadvantages</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="web-based-apis.html"><a href="web-based-apis.html"><i class="fa fa-check"></i><b>7.4</b> Web-based APIs</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="web-based-apis.html"><a href="web-based-apis.html#what-are-apis"><i class="fa fa-check"></i><b>7.4.1</b> What are APIs?</a></li>
<li class="chapter" data-level="7.4.2" data-path="web-based-apis.html"><a href="web-based-apis.html#accessing-apis-in-r"><i class="fa fa-check"></i><b>7.4.2</b> Accessing APIs in R</a></li>
<li class="chapter" data-level="7.4.3" data-path="web-based-apis.html"><a href="web-based-apis.html#bmrsr"><i class="fa fa-check"></i><b>7.4.3</b> BMRSr</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="databases.html"><a href="databases.html"><i class="fa fa-check"></i><b>7.5</b> Databases</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="databases.html"><a href="databases.html#database-management-systems-and-odbc"><i class="fa fa-check"></i><b>7.5.1</b> Database Management Systems and ODBC</a></li>
<li class="chapter" data-level="7.5.2" data-path="databases.html"><a href="databases.html#connecting-with-the-odbc-package"><i class="fa fa-check"></i><b>7.5.2</b> Connecting with the <code>odbc</code> package</a></li>
<li class="chapter" data-level="7.5.3" data-path="databases.html"><a href="databases.html#querying-the-database"><i class="fa fa-check"></i><b>7.5.3</b> Querying the database</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cleaning.html"><a href="cleaning.html"><i class="fa fa-check"></i><b>8</b> Cleaning</a>
<ul>
<li class="chapter" data-level="8.1" data-path="filtering.html"><a href="filtering.html"><i class="fa fa-check"></i><b>8.1</b> Filtering</a></li>
<li class="chapter" data-level="8.2" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>8.2</b> Missing values</a></li>
<li class="chapter" data-level="8.3" data-path="changing-column-types.html"><a href="changing-column-types.html"><i class="fa fa-check"></i><b>8.3</b> Changing column types</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tidying.html"><a href="tidying.html"><i class="fa fa-check"></i><b>9</b> Tidying</a>
<ul>
<li class="chapter" data-level="9.1" data-path="pivoting.html"><a href="pivoting.html"><i class="fa fa-check"></i><b>9.1</b> Pivoting</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="pivoting.html"><a href="pivoting.html#pivoting-columns-to-rows-longer"><i class="fa fa-check"></i><b>9.1.1</b> Pivoting columns to rows (longer)</a></li>
<li class="chapter" data-level="9.1.2" data-path="pivoting.html"><a href="pivoting.html#pivoting-rows-to-columns-wider"><i class="fa fa-check"></i><b>9.1.2</b> Pivoting rows to columns (wider)</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="separating-uniting.html"><a href="separating-uniting.html"><i class="fa fa-check"></i><b>9.2</b> Separating &amp; Uniting</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="separating-uniting.html"><a href="separating-uniting.html#separating"><i class="fa fa-check"></i><b>9.2.1</b> Separating</a></li>
<li class="chapter" data-level="9.2.2" data-path="separating-uniting.html"><a href="separating-uniting.html#uniting"><i class="fa fa-check"></i><b>9.2.2</b> Uniting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="grouping.html"><a href="grouping.html"><i class="fa fa-check"></i><b>10</b> Grouping</a></li>
<li class="chapter" data-level="11" data-path="mutating.html"><a href="mutating.html"><i class="fa fa-check"></i><b>11</b> Mutating</a></li>
<li class="chapter" data-level="12" data-path="summarising.html"><a href="summarising.html"><i class="fa fa-check"></i><b>12</b> Summarising</a></li>
<li class="chapter" data-level="13" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>13</b> Plotting</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>13.1</b> ggplot2</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="ggplot2.html"><a href="ggplot2.html#components"><i class="fa fa-check"></i><b>13.1.1</b> Components</a></li>
<li class="chapter" data-level="13.1.2" data-path="ggplot2.html"><a href="ggplot2.html#layers"><i class="fa fa-check"></i><b>13.1.2</b> Layers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="modelling.html"><a href="modelling.html"><i class="fa fa-check"></i><b>14</b> Modelling</a>
<ul>
<li class="chapter" data-level="14.1" data-path="types-of-model.html"><a href="types-of-model.html"><i class="fa fa-check"></i><b>14.1</b> Types of model</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="types-of-model.html"><a href="types-of-model.html#linear-models"><i class="fa fa-check"></i><b>14.1.1</b> Linear models</a></li>
<li class="chapter" data-level="14.1.2" data-path="types-of-model.html"><a href="types-of-model.html#quadratic-exponential-models"><i class="fa fa-check"></i><b>14.1.2</b> Quadratic &amp; Exponential Models</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="coefficients.html"><a href="coefficients.html"><i class="fa fa-check"></i><b>14.2</b> Coefficients</a></li>
<li class="chapter" data-level="14.3" data-path="residuals.html"><a href="residuals.html"><i class="fa fa-check"></i><b>14.3</b> Residuals</a></li>
<li class="chapter" data-level="14.4" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>14.4</b> <code>lm()</code></a></li>
<li class="chapter" data-level="14.5" data-path="multiple-predictors.html"><a href="multiple-predictors.html"><i class="fa fa-check"></i><b>14.5</b> Multiple Predictors</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="multiple-predictors.html"><a href="multiple-predictors.html#simple-effects"><i class="fa fa-check"></i><b>14.5.1</b> Simple effects</a></li>
<li class="chapter" data-level="14.5.2" data-path="multiple-predictors.html"><a href="multiple-predictors.html#interaction-effects"><i class="fa fa-check"></i><b>14.5.2</b> Interaction effects</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="evaluating-models.html"><a href="evaluating-models.html"><i class="fa fa-check"></i><b>14.6</b> Evaluating Models</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="evaluating-models.html"><a href="evaluating-models.html#lm-output"><i class="fa fa-check"></i><b>14.6.1</b> <code>lm()</code> Output</a></li>
<li class="chapter" data-level="14.6.2" data-path="evaluating-models.html"><a href="evaluating-models.html#residuals-1"><i class="fa fa-check"></i><b>14.6.2</b> Residuals</a></li>
<li class="chapter" data-level="14.6.3" data-path="evaluating-models.html"><a href="evaluating-models.html#overfitting"><i class="fa fa-check"></i><b>14.6.3</b> Overfitting</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="video-game-sales-model.html"><a href="video-game-sales-model.html"><i class="fa fa-check"></i><b>14.7</b> Video Game Sales Model</a></li>
<li class="chapter" data-level="14.8" data-path="questions-3.html"><a href="questions-3.html"><i class="fa fa-check"></i><b>14.8</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>15</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="15.1" data-path="neural-networks.html"><a href="neural-networks.html"><i class="fa fa-check"></i><b>15.1</b> Neural networks</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="neural-networks.html"><a href="neural-networks.html#introduction"><i class="fa fa-check"></i><b>15.1.1</b> Introduction</a></li>
<li class="chapter" data-level="15.1.2" data-path="neural-networks.html"><a href="neural-networks.html#example"><i class="fa fa-check"></i><b>15.1.2</b> Example</a></li>
<li class="chapter" data-level="15.1.3" data-path="neural-networks.html"><a href="neural-networks.html#neural-networks-in-r"><i class="fa fa-check"></i><b>15.1.3</b> Neural Networks in R</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Projects</b></span></li>
<li class="chapter" data-level="16" data-path="projects-introduction.html"><a href="projects-introduction.html"><i class="fa fa-check"></i><b>16</b> Introduction</a></li>
<li class="chapter" data-level="17" data-path="workflows.html"><a href="workflows.html"><i class="fa fa-check"></i><b>17</b> Workflows</a>
<ul>
<li class="chapter" data-level="17.1" data-path="basic-workflow.html"><a href="basic-workflow.html"><i class="fa fa-check"></i><b>17.1</b> Basic Workflow</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="basic-workflow.html"><a href="basic-workflow.html#example-1-reporting"><i class="fa fa-check"></i><b>17.1.1</b> Example 1: Reporting</a></li>
<li class="chapter" data-level="17.1.2" data-path="basic-workflow.html"><a href="basic-workflow.html#example-2-modelling"><i class="fa fa-check"></i><b>17.1.2</b> Example 2: Modelling</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="separating-stages.html"><a href="separating-stages.html"><i class="fa fa-check"></i><b>17.2</b> Separating Stages</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="separating-stages.html"><a href="separating-stages.html#functions"><i class="fa fa-check"></i><b>17.2.1</b> Functions</a></li>
<li class="chapter" data-level="17.2.2" data-path="separating-stages.html"><a href="separating-stages.html#files"><i class="fa fa-check"></i><b>17.2.2</b> Files</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>17.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="replicability.html"><a href="replicability.html"><i class="fa fa-check"></i><b>18</b> Replicability</a>
<ul>
<li class="chapter" data-level="18.1" data-path="good-practice.html"><a href="good-practice.html"><i class="fa fa-check"></i><b>18.1</b> Good practice</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="good-practice.html"><a href="good-practice.html#use-a-consistent-naming-convention"><i class="fa fa-check"></i><b>18.1.1</b> Use a consistent naming convention</a></li>
<li class="chapter" data-level="18.1.2" data-path="good-practice.html"><a href="good-practice.html#name-your-variables-as-nouns-and-your-functions-as-verbs"><i class="fa fa-check"></i><b>18.1.2</b> Name your variables as nouns and your functions as verbs</a></li>
<li class="chapter" data-level="18.1.3" data-path="good-practice.html"><a href="good-practice.html#use-functions-where-you-can"><i class="fa fa-check"></i><b>18.1.3</b> Use functions where you can</a></li>
<li class="chapter" data-level="18.1.4" data-path="good-practice.html"><a href="good-practice.html#state-your-dependencies"><i class="fa fa-check"></i><b>18.1.4</b> State your dependencies</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="documentation.html"><a href="documentation.html"><i class="fa fa-check"></i><b>18.2</b> Documentation</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="documentation.html"><a href="documentation.html#function-documentation"><i class="fa fa-check"></i><b>18.2.1</b> Function documentation</a></li>
<li class="chapter" data-level="18.2.2" data-path="documentation.html"><a href="documentation.html#long-form-documentation"><i class="fa fa-check"></i><b>18.2.2</b> Long-form documentation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="projects-as-packages.html"><a href="projects-as-packages.html"><i class="fa fa-check"></i><b>19</b> Projects as Packages</a>
<ul>
<li class="chapter" data-level="19.1" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>19.1</b> Structure</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="structure.html"><a href="structure.html#r-code"><i class="fa fa-check"></i><b>19.1.1</b> R code</a></li>
<li class="chapter" data-level="19.1.2" data-path="structure.html"><a href="structure.html#data"><i class="fa fa-check"></i><b>19.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="documentation-1.html"><a href="documentation-1.html"><i class="fa fa-check"></i><b>19.2</b> Documentation</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="documentation-1.html"><a href="documentation-1.html#functional"><i class="fa fa-check"></i><b>19.2.1</b> Functional</a></li>
<li class="chapter" data-level="19.2.2" data-path="documentation-1.html"><a href="documentation-1.html#long-form"><i class="fa fa-check"></i><b>19.2.2</b> Long-form</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="description.html"><a href="description.html"><i class="fa fa-check"></i><b>19.3</b> DESCRIPTION</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="description.html"><a href="description.html#dependencies"><i class="fa fa-check"></i><b>19.3.1</b> Dependencies</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="abstraction.html"><a href="abstraction.html"><i class="fa fa-check"></i><b>19.4</b> Abstraction</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="git-github.html"><a href="git-github.html"><i class="fa fa-check"></i><b>20</b> Git &amp; GitHub</a></li>
<li class="chapter" data-level="21" data-path="project-example.html"><a href="project-example.html"><i class="fa fa-check"></i><b>21</b> Project Example</a></li>
<li class="part"><span><b>IV Question Answers</b></span></li>
<li class="chapter" data-level="22" data-path="answers.html"><a href="answers.html"><i class="fa fa-check"></i><b>22</b> Answers</a>
<ul>
<li class="chapter" data-level="22.1" data-path="tidy-data-1.html"><a href="tidy-data-1.html"><i class="fa fa-check"></i><b>22.1</b> “Tidy” data</a></li>
<li class="chapter" data-level="22.2" data-path="the-pipe-1.html"><a href="the-pipe-1.html"><i class="fa fa-check"></i><b>22.2</b> The pipe (%&gt;%)</a></li>
<li class="chapter" data-level="22.3" data-path="quasiquotation-1.html"><a href="quasiquotation-1.html"><i class="fa fa-check"></i><b>22.3</b> Quasiquotation</a></li>
<li class="chapter" data-level="22.4" data-path="loading-1.html"><a href="loading-1.html"><i class="fa fa-check"></i><b>22.4</b> Loading</a></li>
<li class="chapter" data-level="22.5" data-path="cleaning-1.html"><a href="cleaning-1.html"><i class="fa fa-check"></i><b>22.5</b> Cleaning</a></li>
<li class="chapter" data-level="22.6" data-path="tidying-1.html"><a href="tidying-1.html"><i class="fa fa-check"></i><b>22.6</b> Tidying</a></li>
<li class="chapter" data-level="22.7" data-path="grouping-1.html"><a href="grouping-1.html"><i class="fa fa-check"></i><b>22.7</b> Grouping</a></li>
<li class="chapter" data-level="22.8" data-path="mutating-1.html"><a href="mutating-1.html"><i class="fa fa-check"></i><b>22.8</b> Mutating</a></li>
<li class="chapter" data-level="22.9" data-path="summarising-1.html"><a href="summarising-1.html"><i class="fa fa-check"></i><b>22.9</b> Summarising</a></li>
<li class="chapter" data-level="22.10" data-path="plotting-1.html"><a href="plotting-1.html"><i class="fa fa-check"></i><b>22.10</b> Plotting</a></li>
<li class="chapter" data-level="22.11" data-path="modelling-1.html"><a href="modelling-1.html"><i class="fa fa-check"></i><b>22.11</b> Modelling</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">opeRate</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="neural-networks" class="section level2" number="15.1">
<h2><span class="header-section-number">15.1</span> Neural networks</h2>
<div id="introduction" class="section level3" number="15.1.1">
<h3><span class="header-section-number">15.1.1</span> Introduction</h3>
<p>Neural networks were developed in an attempt to model how neurons in the brain may function. Neurons process inputs and then produce outputs by either firing or not firing. If the inputs to a neuron breach a threshold, then the neuron fires. If that threshold isn’t reached, then it doesn’t fire. That neuron will then become an input to a subsequent neuron. This network of interconnected nodes can then connect a certain input pattern with a corresponding output pattern.</p>
<p>Importantly, the inputs have weights that can change due to feedback. So if an input erroneously results in a neuron firing, then the weights of the inputs can be adjusted to ensure that the neuron doesn’t fire again if it’s presented with the same information.</p>
<p><img src="img/Template.png" /><!-- --></p>
<p><img src="img/Positive.png" width="50%" /></p>
<p><img src="img/Negative.png" width="50%" /></p>
</div>
<div id="example" class="section level3" number="15.1.2">
<h3><span class="header-section-number">15.1.2</span> Example</h3>
<p>Let’s model how a neural network might learn to identify a lemon from a collection of fruits. When an object is presented, it’s broken down into its constituent features, which are then treated as the first set of inputs. For now, let’s imagine we have three features; ‘is yellow’, ‘is round’, ‘is sour’. The value of each of these is either going to be 1 (true) or 0 (false). These three inputs then feed into a second node. That node has a threshold that needs to be met before it will fire. When it fires, that means the model thinks that the fruit that’s been presented is a lemon.</p>
<p><img src="img/Lemon%20example.png" /><!-- --></p>
<p>To start off, let’s set the weights for our inputs to all be 1, and the threshold for our second node to fire as 1. Let’s present our first object, which is an orange:</p>
<p><img src="img/Orange.png" /><!-- --></p>
<p>The neuron has fired, but it’s definitely not a lemon. The orange has triggered one of the three inputs to be 1, but because the threshold for the second node to fire is 1, that one input is enough to pass the threshold. We need to decrease our weights. For now, let’s drop them all down to 0.25.</p>
<p>Now let’s present our next object, which is a lime:</p>
<p><img src="img/Lime.png" /><!-- --></p>
<p>In this case, we’ve triggered two of the three inputs but this time the threshold hasn’t been met and so the second node hasn’t fired. The model is saying that this isn’t a lemon and it’s correct. For now, we don’t need to change the weights.</p>
<p>Next, we present it with a lemon:</p>
<p><img src="img/Lemon.png" /><!-- --></p>
<p>Now all of the three inputs are triggered, but this isn’t enough to pass the threshold, so the second node doesn’t fire. This is a lemon though, so it should have fired. We need to change our weights again.</p>
<p>We won’t go through the painstaking process of changing the weights until we get them right, but hopefully this has demonstrated the key process by which a neural network learns; by changing the weights of its input layers to match inputs with outputs.</p>
<p>In this case, we’ve done an extremely simple example. In reality, no neural network is as simple as this because it would be pointless. Instead, neural networks usually have multiple layers and many many more inputs. If we consider models that can read through text documents and classify them (e.g. classify reviews as being positive or negative), these will often use every word in the text as an input. As you can imagine, this can lead to a lot of inputs!</p>
</div>
<div id="neural-networks-in-r" class="section level3" number="15.1.3">
<h3><span class="header-section-number">15.1.3</span> Neural Networks in R</h3>
<p>There are lots of different packages that have been developed to create neural networks in R. For larger projects, I use the <code>{keras}</code> package which used the TensorFlow library to create machine learning models with support for GPU-accelerated learning. <code>{keras}</code> requires Python to be installed however and can be tough to learn due to its scale and flexiblity. For now, we’re going to use the <code>{neuralnet}</code> package. It’s a little on the older side but it uses a similar syntax to the <code>lm()</code> function so we can use what we’ve learnt so far.</p>
<p>For this example, let’s create a neural network that will predict whether the publisher was Take-Two or Sega based on what platform the game was released on, what the genre was and how well the game sold. Let’s start with our dataset:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="neural-networks.html#cb166-1" aria-hidden="true" tabindex="-1"></a>nn_vgsales <span class="ot">&lt;-</span> tidy_vg_sales <span class="sc">%&gt;%</span></span>
<span id="cb166-2"><a href="neural-networks.html#cb166-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Sales <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-3"><a href="neural-networks.html#cb166-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;Global&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-4"><a href="neural-networks.html#cb166-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Publisher <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;LucasArts&quot;</span>, <span class="st">&quot;Sega&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb166-5"><a href="neural-networks.html#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Need to convert these columns to numeric for the NN</span></span>
<span id="cb166-6"><a href="neural-networks.html#cb166-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(dplyr<span class="sc">::</span><span class="fu">across</span>(<span class="fu">c</span>(Genre, Platform), <span class="sc">~</span><span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(.x))))</span></code></pre></div>
<p>Now let’s split the dataset into a training and test set. We’re going to use the <code>{withr}</code> package to set a random seed when selecting the test and training set so that it’s the same each time.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="neural-networks.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The `with_seed()` just ensures we&#39;re using the same training set each time</span></span>
<span id="cb167-2"><a href="neural-networks.html#cb167-2" aria-hidden="true" tabindex="-1"></a>withr<span class="sc">::</span><span class="fu">with_seed</span>(<span class="dv">1234</span>, {</span>
<span id="cb167-3"><a href="neural-networks.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  training_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(nn_vgsales), <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">nrow</span>(nn_vgsales))</span>
<span id="cb167-4"><a href="neural-networks.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-5"><a href="neural-networks.html#cb167-5" aria-hidden="true" tabindex="-1"></a>  nn_vgsales_train <span class="ot">&lt;-</span> nn_vgsales[training_indices,]</span>
<span id="cb167-6"><a href="neural-networks.html#cb167-6" aria-hidden="true" tabindex="-1"></a>  nn_vgsales_test <span class="ot">&lt;-</span> nn_vgsales[<span class="sc">-</span>training_indices,]</span>
<span id="cb167-7"><a href="neural-networks.html#cb167-7" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Now let’s create our model and then plot it using the <code>{neuralnet}</code> package.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="neural-networks.html#cb168-1" aria-hidden="true" tabindex="-1"></a>nn <span class="ot">&lt;-</span> neuralnet<span class="sc">::</span><span class="fu">neuralnet</span>(<span class="at">data =</span> nn_vgsales_train,</span>
<span id="cb168-2"><a href="neural-networks.html#cb168-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">formula =</span> (Publisher <span class="sc">==</span> <span class="st">&quot;LucasArts&quot;</span>) <span class="sc">+</span> (Publisher <span class="sc">==</span> <span class="st">&quot;Sega&quot;</span>) <span class="sc">~</span> Platform <span class="sc">+</span> Genre <span class="sc">+</span> Sales,</span>
<span id="cb168-3"><a href="neural-networks.html#cb168-3" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># We&#39;re creating a classication model rather than a regression model</span></span>
<span id="cb168-4"><a href="neural-networks.html#cb168-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">linear.output =</span> <span class="cn">FALSE</span>)</span>
<span id="cb168-5"><a href="neural-networks.html#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="neural-networks.html#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nn)</span></code></pre></div>
<p>Now let’s apply our model to our test set and have a look at how good the predictions are:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="neural-networks.html#cb169-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(nn, nn_vgsales_test)</span>
<span id="cb169-2"><a href="neural-networks.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(nn_vgsales_test<span class="sc">$</span>Publisher, <span class="fu">apply</span>(pred, <span class="dv">1</span>, which.max))</span></code></pre></div>
<pre><code>##            
##              1  2
##   LucasArts 14  4
##   Sega       1 34</code></pre>
<p>This matrix can help us understand how well the model is predicting. Three useful metrics we can easily calculate from this metric are the model’s <strong>accuracy</strong>, <strong>precision</strong> and <strong>recall</strong>.</p>
<p><strong>Accuracy</strong>
The accuracy is predicted at the model level, and is calculated as the number of correct guesses divided by the total number of cases. In our case that’s
<code>(14+34)/(1+4+14+34)</code>, which is 0.91.</p>
<p><strong>Precision</strong>
The precision of a model tells us how many of the instances that were predicted to be in a certain group <strong>were actually</strong> in that group.
Precision, therefore, is a per-group metric. So in our example, we will have a precision metric for both LucasArts and Sega.</p>
<p>The precision is calculated as the number of true positives over the number of true positives plus false positives. For Sega, that’s
<code>34/(34+4)</code>, which is 0.89. For LucasArts, that’s <code>14/(14+1)</code>, which is 0.93. This tells us that our model is more accurate in predicting LucasArts games.</p>
<p><strong>Recall</strong>
The recall of a model tells us how many instances of a particular group were correctly predicted to be in that group. This answers a different but related question to the one that the precision metric answers. Once again, the recall metric is calculated for each group/classifier.</p>
<p>To calculate our recall metric, we need to divide the number of correctly predicted classifications over the total number of actual instances in that group. For Sega, that’s <code>34/(34+1)</code>, which is 0.97. For LucasArts, that’s <code>14/(14+4)</code>, which is 0.78.</p>
<p>So what should you aim for - high precision or high recall? Well really it depends on what problem you’re trying to solve. If you imagine that you’ve got a model to detect cancer, then you won’t want to miss when someone actually does have cancer, even if you’ll end up predicting that a few people do have cancer when they don’t. To do this, you’ll want to prioritise <strong>recall</strong>. Alternatively, say you’re building a model to choose which funds to invest in. In that case, the cost of investing is high, so you want to make sure that when you go with a fund, it’s actually going to make money, even if you miss out on other funds that would have also made money. In this situation, the <strong>precision</strong> of your model would be more important.</p>

</div>
</div>
<!-- </div> -->



</div>
            </section>

          </div>
        </div>
      </div>
<a href="machine-learning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="projects-introduction.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
