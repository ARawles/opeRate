<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.2 Returns | opeRate</title>
  <meta name="description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="7.2 Returns | opeRate" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="cover.png" />
  <meta property="og:description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="github-repo" content="ARawles/opeRate" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.2 Returns | opeRate" />
  
  <meta name="twitter:description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="twitter:image" content="cover.png" />

<meta name="author" content="Adam Rawles" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="abstraction.html"/>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> opeRate</a>
<ul>
<li class="chapter" data-level="1.1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>1.1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="overview.html"><a href="overview.html#acknowledgements"><i class="fa fa-check"></i><b>1.1.1</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="about-me.html"><a href="about-me.html"><i class="fa fa-check"></i><b>1.2</b> About Me</a></li>
<li class="chapter" data-level="1.3" data-path="using-r.html"><a href="using-r.html"><i class="fa fa-check"></i><b>1.3</b> Using R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="projects.html"><a href="projects.html"><i class="fa fa-check"></i><b>2</b> Projects</a>
<ul>
<li class="chapter" data-level="2.1" data-path="workflows.html"><a href="workflows.html"><i class="fa fa-check"></i><b>2.1</b> Workflows</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="workflows.html"><a href="workflows.html#basic-workflows"><i class="fa fa-check"></i><b>2.1.1</b> Basic Workflows</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="replicability.html"><a href="replicability.html"><i class="fa fa-check"></i><b>2.2</b> Replicability</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="replicability.html"><a href="replicability.html#good-practice"><i class="fa fa-check"></i><b>2.2.1</b> Good practice</a></li>
<li class="chapter" data-level="2.2.2" data-path="replicability.html"><a href="replicability.html#rmarkdown"><i class="fa fa-check"></i><b>2.2.2</b> RMarkdown</a></li>
<li class="chapter" data-level="2.2.3" data-path="replicability.html"><a href="replicability.html#shiny"><i class="fa fa-check"></i><b>2.2.3</b> Shiny</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="projects-as-packages.html"><a href="projects-as-packages.html"><i class="fa fa-check"></i><b>2.3</b> Projects as packages</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>3</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tidyr.html"><a href="tidyr.html"><i class="fa fa-check"></i><b>3.1</b> tidyr</a></li>
<li class="chapter" data-level="3.2" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>3.2</b> dplyr</a></li>
<li class="chapter" data-level="3.3" data-path="stringr.html"><a href="stringr.html"><i class="fa fa-check"></i><b>3.3</b> stringr</a></li>
<li class="chapter" data-level="3.4" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>3.4</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>4</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="loading-data.html"><a href="loading-data.html"><i class="fa fa-check"></i><b>4.1</b> Loading data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="loading-data.html"><a href="loading-data.html#csv"><i class="fa fa-check"></i><b>4.1.1</b> csv</a></li>
<li class="chapter" data-level="4.1.2" data-path="loading-data.html"><a href="loading-data.html#excel-files"><i class="fa fa-check"></i><b>4.1.2</b> Excel files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="using-apis.html"><a href="using-apis.html"><i class="fa fa-check"></i><b>4.2</b> Using APIs</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="using-apis.html"><a href="using-apis.html#what-are-apis"><i class="fa fa-check"></i><b>4.2.1</b> What are APIs?</a></li>
<li class="chapter" data-level="4.2.2" data-path="using-apis.html"><a href="using-apis.html#accessing-apis-in-r"><i class="fa fa-check"></i><b>4.2.2</b> Accessing APIs in R</a></li>
<li class="chapter" data-level="4.2.3" data-path="using-apis.html"><a href="using-apis.html#bmrsr"><i class="fa fa-check"></i><b>4.2.3</b> BMRSr</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="cleaning-and-tidying-data.html"><a href="cleaning-and-tidying-data.html"><i class="fa fa-check"></i><b>4.3</b> Cleaning and tidying data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="cleaning-and-tidying-data.html"><a href="cleaning-and-tidying-data.html#cleaning"><i class="fa fa-check"></i><b>4.3.1</b> Cleaning</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="section.html"><a href="section.html"><i class="fa fa-check"></i><b>4.4</b> </a></li>
<li class="chapter" data-level="4.5" data-path="summarisation.html"><a href="summarisation.html"><i class="fa fa-check"></i><b>4.5</b> Summarisation</a></li>
<li class="chapter" data-level="4.6" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>4.6</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="advanced-data-analysis.html"><a href="advanced-data-analysis.html"><i class="fa fa-check"></i><b>5</b> Advanced data analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="plotting-1.html"><a href="plotting-1.html"><i class="fa fa-check"></i><b>5.1</b> Plotting</a></li>
<li class="chapter" data-level="5.2" data-path="modelling.html"><a href="modelling.html"><i class="fa fa-check"></i><b>5.2</b> Modelling</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="shiny-1.html"><a href="shiny-1.html"><i class="fa fa-check"></i><b>6</b> Shiny</a></li>
<li class="chapter" data-level="7" data-path="theory.html"><a href="theory.html"><i class="fa fa-check"></i><b>7</b> Theory</a>
<ul>
<li class="chapter" data-level="7.1" data-path="abstraction.html"><a href="abstraction.html"><i class="fa fa-check"></i><b>7.1</b> Abstraction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="abstraction.html"><a href="abstraction.html#definition"><i class="fa fa-check"></i><b>7.1.1</b> Definition</a></li>
<li class="chapter" data-level="7.1.2" data-path="abstraction.html"><a href="abstraction.html#abstraction-in-r"><i class="fa fa-check"></i><b>7.1.2</b> Abstraction in R</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="returns.html"><a href="returns.html"><i class="fa fa-check"></i><b>7.2</b> Returns</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">opeRate</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="returns" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Returns</h2>
<p>As R is a functional language, functions (and therefore the values that they return) are an important thing to understand as a user. As we learned in the <a href="http://arawles.co.uk/teacher">teacheR</a> book, when you write a function, the return value will be whatever was last evaluated in that function definition, unless you specified a <code>return()</code> call. This “early return” strategy, however, is often a point of contention. Let’s have a look at the different points of view:</p>
<ol style="list-style-type: decimal">
<li><strong>There shouldn’t be any early returns</strong></li>
</ol>
<p>At one extreme, there are people who teach that you shouldn’t return something early from a function (unless there’s an error). In practice, this might look something like this:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="returns.html#cb41-1" aria-hidden="true" tabindex="-1"></a>late_bird <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, w, <span class="at">add_w =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb41-2"><a href="returns.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> x <span class="sc">+</span> y</span>
<span id="cb41-3"><a href="returns.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (add_w) {</span>
<span id="cb41-4"><a href="returns.html#cb41-4" aria-hidden="true" tabindex="-1"></a>    ret <span class="ot">&lt;-</span> ret <span class="sc">+</span> w</span>
<span id="cb41-5"><a href="returns.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-6"><a href="returns.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  ret</span>
<span id="cb41-7"><a href="returns.html#cb41-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>So what’s going on here? Well, we’re creating a variable (called <code>ret</code>) and always returning that at the end of our function. The value of <code>ret</code> changes depending on our parameters, but we always return the value of that <code>ret</code> variable.</p>
<p>On the one hand, this makes it clear <em>which</em> variable is being returned. But on the other, it’s not always clear <em>what</em> the value of that variable is. We have to scan down the whole body of the function to see what happens to ret, even though if we set <code>add_w</code> to FALSE, nothing happens after the original call.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Never use a common return variable</strong></li>
</ol>
<p>At the other end, we could completely avoid return placeholder variables:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="returns.html#cb42-1" aria-hidden="true" tabindex="-1"></a>early_bird <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, w, <span class="at">add_w =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb42-2"><a href="returns.html#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (add_w) {</span>
<span id="cb42-3"><a href="returns.html#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x <span class="sc">+</span> y <span class="sc">+</span> w)</span>
<span id="cb42-4"><a href="returns.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-5"><a href="returns.html#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x <span class="sc">+</span> y) </span>
<span id="cb42-6"><a href="returns.html#cb42-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-7"><a href="returns.html#cb42-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Unlike the first example, we only have to read down until the path that we’ve chosen is finished. For example, if <code>add_w</code> is TRUE, then we only need to read down until the first <code>return()</code> call and we know what we’re going to get. However, this approach would probably be more complicated if we had more than 2 paths or if we’re doing complicated actions. Plus, we’re duplicating our code here a bit by specifying the <code>x + y</code> part in both <code>return()</code> calls.</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Return early when possible</strong></li>
</ol>
<p>And finally, we reach a more middle-of-the-road approach:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="returns.html#cb43-1" aria-hidden="true" tabindex="-1"></a>middle_bird <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, w, <span class="at">add_w =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb43-2"><a href="returns.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> x <span class="sc">+</span> y</span>
<span id="cb43-3"><a href="returns.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (add_w) {</span>
<span id="cb43-4"><a href="returns.html#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(ret <span class="sc">+</span> w)</span>
<span id="cb43-5"><a href="returns.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-6"><a href="returns.html#cb43-6" aria-hidden="true" tabindex="-1"></a>  ret </span>
<span id="cb43-7"><a href="returns.html#cb43-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here we use an intermediate variable to avoid duplicating our <code>x + y</code> operation, but then we return when we’re ready, meaning that someone doesn’t have to read to the bottom of the function if they’ve chosen the <code>add_w</code> path.</p>
<p>And herein lies the crux of the issue. Early returns have been a hot topic since the inception of computer programming, and people will continue to have their opinions on what the correct approach should be, so here’s mine:</p>
<p>The final return value should follow the “happy” path. That is, if you used the function with its default parameters, it should reach the end and return the final evaluation. Otherwise, you should probably be returning early. This way, when people first glance at the function, they can easily understand the logic and the “default” return value. From there, they can then monitor the edge cases to understand how the return value changes.</p>
<p>So what does this look like exactly? Well, Example 3 is close, but it doesn’t return via the final evaluation for the “happy” path. Let’s fix that:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="returns.html#cb44-1" aria-hidden="true" tabindex="-1"></a>adams_bird <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, w, <span class="at">add_w =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb44-2"><a href="returns.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  ret <span class="ot">&lt;-</span> x <span class="sc">+</span> y</span>
<span id="cb44-3"><a href="returns.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>add_w) {</span>
<span id="cb44-4"><a href="returns.html#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(ret)</span>
<span id="cb44-5"><a href="returns.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-6"><a href="returns.html#cb44-6" aria-hidden="true" tabindex="-1"></a>  ret <span class="sc">+</span> w</span>
<span id="cb44-7"><a href="returns.html#cb44-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-8"><a href="returns.html#cb44-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now, the “happy” path works its way all the way down to the final expression <code>ret + w</code>. But when we change the default value for <code>add_w</code> and then deviate from the strict “happy” path, we see an early return call when we’re ready.</p>
<p>Of course, this approach won’t always be the easiest to understand - for example, if you have a parameter that changes the path at multiple points, then you won’t be able to return until later in the function anyway, but to me this approach is the most conducive to readable code.</p>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="abstraction.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
