<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.5 Mutation (new columns) | opeRate</title>
  <meta name="description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4.5 Mutation (new columns) | opeRate" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="cover.png" />
  <meta property="og:description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="github-repo" content="ARawles/opeRate" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.5 Mutation (new columns) | opeRate" />
  
  <meta name="twitter:description" content="Apply your knowledge of the R programming language to real problems and tasks." />
  <meta name="twitter:image" content="cover.png" />

<meta name="author" content="Adam Rawles" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="pivoting-columns.html"/>
<link rel="next" href="summarisation.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> opeRate</a>
<ul>
<li class="chapter" data-level="1.1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>1.1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="overview.html"><a href="overview.html#acknowledgements"><i class="fa fa-check"></i><b>1.1.1</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="about-me.html"><a href="about-me.html"><i class="fa fa-check"></i><b>1.2</b> About Me</a></li>
<li class="chapter" data-level="1.3" data-path="using-r.html"><a href="using-r.html"><i class="fa fa-check"></i><b>1.3</b> Using R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>2</b> tidyverse</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>2.1</b> “Tidy” data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="tidy-data.html"><a href="tidy-data.html#exceptions"><i class="fa fa-check"></i><b>2.1.1</b> Exceptions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="the-pipe.html"><a href="the-pipe.html"><i class="fa fa-check"></i><b>2.2</b> The pipe (<code>%&gt;%</code>)</a></li>
<li class="chapter" data-level="2.3" data-path="quasiquotation.html"><a href="quasiquotation.html"><i class="fa fa-check"></i><b>2.3</b> Quasiquotation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="projects.html"><a href="projects.html"><i class="fa fa-check"></i><b>3</b> Projects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="workflows.html"><a href="workflows.html"><i class="fa fa-check"></i><b>3.1</b> Workflows</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="workflows.html"><a href="workflows.html#basic-workflow"><i class="fa fa-check"></i><b>3.1.1</b> Basic Workflow</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="replicability.html"><a href="replicability.html"><i class="fa fa-check"></i><b>3.2</b> Replicability</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="replicability.html"><a href="replicability.html#good-practice"><i class="fa fa-check"></i><b>3.2.1</b> Good practice</a></li>
<li class="chapter" data-level="3.2.2" data-path="replicability.html"><a href="replicability.html#documentation"><i class="fa fa-check"></i><b>3.2.2</b> Documentation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="projects-as-packages.html"><a href="projects-as-packages.html"><i class="fa fa-check"></i><b>3.3</b> Projects as Packages</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="projects-as-packages.html"><a href="projects-as-packages.html#structure"><i class="fa fa-check"></i><b>3.3.1</b> Structure</a></li>
<li class="chapter" data-level="3.3.2" data-path="projects-as-packages.html"><a href="projects-as-packages.html#documentation-1"><i class="fa fa-check"></i><b>3.3.2</b> Documentation</a></li>
<li class="chapter" data-level="3.3.3" data-path="projects-as-packages.html"><a href="projects-as-packages.html#description"><i class="fa fa-check"></i><b>3.3.3</b> DESCRIPTION</a></li>
<li class="chapter" data-level="3.3.4" data-path="projects-as-packages.html"><a href="projects-as-packages.html#abstraction"><i class="fa fa-check"></i><b>3.3.4</b> Abstraction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>4</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="loading-data.html"><a href="loading-data.html"><i class="fa fa-check"></i><b>4.1</b> Loading data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="loading-data.html"><a href="loading-data.html#csv"><i class="fa fa-check"></i><b>4.1.1</b> csv</a></li>
<li class="chapter" data-level="4.1.2" data-path="loading-data.html"><a href="loading-data.html#excel-files"><i class="fa fa-check"></i><b>4.1.2</b> Excel files</a></li>
<li class="chapter" data-level="4.1.3" data-path="loading-data.html"><a href="loading-data.html#using-apis"><i class="fa fa-check"></i><b>4.1.3</b> Using APIs</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="cleaning-data.html"><a href="cleaning-data.html"><i class="fa fa-check"></i><b>4.2</b> Cleaning data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="cleaning-data.html"><a href="cleaning-data.html#missing-values"><i class="fa fa-check"></i><b>4.2.1</b> Missing values</a></li>
<li class="chapter" data-level="4.2.2" data-path="cleaning-data.html"><a href="cleaning-data.html#changing-column-types"><i class="fa fa-check"></i><b>4.2.2</b> Changing column types</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tidying.html"><a href="tidying.html"><i class="fa fa-check"></i><b>4.3</b> Tidying</a></li>
<li class="chapter" data-level="4.4" data-path="pivoting-columns.html"><a href="pivoting-columns.html"><i class="fa fa-check"></i><b>4.4</b> Pivoting columns</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="pivoting-columns.html"><a href="pivoting-columns.html#pivoting-columns-to-rows-longer"><i class="fa fa-check"></i><b>4.4.1</b> Pivoting columns to rows (longer)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="mutation-new-columns.html"><a href="mutation-new-columns.html"><i class="fa fa-check"></i><b>4.5</b> Mutation (new columns)</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="mutation-new-columns.html"><a href="mutation-new-columns.html#grouping"><i class="fa fa-check"></i><b>4.5.1</b> Grouping</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="summarisation.html"><a href="summarisation.html"><i class="fa fa-check"></i><b>4.6</b> Summarisation</a></li>
<li class="chapter" data-level="4.7" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>4.7</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="advanced-data-analysis.html"><a href="advanced-data-analysis.html"><i class="fa fa-check"></i><b>5</b> Advanced data analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="plotting-1.html"><a href="plotting-1.html"><i class="fa fa-check"></i><b>5.1</b> Plotting</a></li>
<li class="chapter" data-level="5.2" data-path="modelling.html"><a href="modelling.html"><i class="fa fa-check"></i><b>5.2</b> Modelling</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">opeRate</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mutation-new-columns" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Mutation (new columns)</h2>
<p>Sometimes you’ll want to add new columns to your data. Most of the time, these will be calculated columns that can be created based on one or more of the other columns in the dataset. To create new columns, we use the <code>dplyr::mutate()</code> function.</p>
<p>Let’s look at how you might mutate your dataset using an example <a href="https://www.kaggle.com/gregorut/videogamesales">Kaggle dataset</a> that holds information on video game sales:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="mutation-new-columns.html#cb50-1" aria-hidden="true" tabindex="-1"></a>vg_sales <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;./data/vgsales.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   Rank = col_double(),
##   Name = col_character(),
##   Platform = col_character(),
##   Year = col_character(),
##   Genre = col_character(),
##   Publisher = col_character(),
##   NA_Sales = col_double(),
##   EU_Sales = col_double(),
##   JP_Sales = col_double(),
##   Other_Sales = col_double(),
##   Global_Sales = col_double()
## )</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="mutation-new-columns.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vg_sales, <span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 16,598 x 11
##    Rank Name  Platform Year  Genre Publisher NA_Sales EU_Sales JP_Sales
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1     1 Wii … Wii      2006  Spor… Nintendo      41.5    29.0      3.77
## 2     2 Supe… NES      1985  Plat… Nintendo      29.1     3.58     6.81
## 3     3 Mari… Wii      2008  Raci… Nintendo      15.8    12.9      3.79
## 4     4 Wii … Wii      2009  Spor… Nintendo      15.8    11.0      3.28
## 5     5 Poke… GB       1996  Role… Nintendo      11.3     8.89    10.2 
## # … with 16,593 more rows, and 2 more variables: Other_Sales &lt;dbl&gt;,
## #   Global_Sales &lt;dbl&gt;</code></pre>
<p>First off, let’s add something simple; a column that calculates the proportion of EU sales compared to global sales. All we need to do is provide the name of our new column to the <code>dplyr::mutate()</code> function and how our new column should be calculated:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="mutation-new-columns.html#cb54-1" aria-hidden="true" tabindex="-1"></a>vg_sales <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="mutation-new-columns.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">EU_Proportion =</span> EU_Sales<span class="sc">/</span>Global_Sales) <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="mutation-new-columns.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 16,598 x 12
##    Rank Name  Platform Year  Genre Publisher NA_Sales EU_Sales JP_Sales
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1     1 Wii … Wii      2006  Spor… Nintendo      41.5    29.0      3.77
## 2     2 Supe… NES      1985  Plat… Nintendo      29.1     3.58     6.81
## 3     3 Mari… Wii      2008  Raci… Nintendo      15.8    12.9      3.79
## 4     4 Wii … Wii      2009  Spor… Nintendo      15.8    11.0      3.28
## 5     5 Poke… GB       1996  Role… Nintendo      11.3     8.89    10.2 
## # … with 16,593 more rows, and 3 more variables: Other_Sales &lt;dbl&gt;,
## #   Global_Sales &lt;dbl&gt;, EU_Proportion &lt;dbl&gt;</code></pre>
<p>As you can see, we’ve created a new column called <code>EU_Proportion</code> and we’ve calculated by dividing the number of EU sales by the total number of sales.</p>
<p>While this is certainly a powerful tool, we’re not really changing the world here. However, we can create more complicated columns by leveraging the concept of applying our function to groups.</p>
<div id="grouping" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Grouping</h3>
<p>When a data frame has one or more groups, the function that’s applied (by <code>dplyr::mutate()</code> here but the logic is the same for <code>dplyr::summarise()</code> which we’ll look at next) is applied for each combination of those groups. So for example with our videa game sales dataset, if we grouped by Publisher, then the calculation in our <code>mutate()</code> function would be done within the scope of each publisher. If we grouped by Publisher and Genre, then the calculation would be done within the scope of each Publisher <strong>and</strong> genre.</p>
<p>To group a dataset, we use the <code>dplyr::group_by()</code> function:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="mutation-new-columns.html#cb56-1" aria-hidden="true" tabindex="-1"></a>grpd_vg_sales <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(vg_sales, Platform)</span></code></pre></div>
<p>The <code>dplyr::group_by()</code> function returns the same dataset but now grouped by the variables you provided. At first, it might not seem as though anything happened - if we print the dataset we still get basically the same output…</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="mutation-new-columns.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(grpd_vg_sales, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 16,598 x 11
## # Groups:   Platform [31]
##     Rank Name  Platform Year  Genre Publisher NA_Sales EU_Sales JP_Sales
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1     1 Wii … Wii      2006  Spor… Nintendo      41.5    29.0      3.77
##  2     2 Supe… NES      1985  Plat… Nintendo      29.1     3.58     6.81
##  3     3 Mari… Wii      2008  Raci… Nintendo      15.8    12.9      3.79
##  4     4 Wii … Wii      2009  Spor… Nintendo      15.8    11.0      3.28
##  5     5 Poke… GB       1996  Role… Nintendo      11.3     8.89    10.2 
##  6     6 Tetr… GB       1989  Puzz… Nintendo      23.2     2.26     4.22
##  7     7 New … DS       2006  Plat… Nintendo      11.4     9.23     6.5 
##  8     8 Wii … Wii      2006  Misc  Nintendo      14.0     9.2      2.93
##  9     9 New … Wii      2009  Plat… Nintendo      14.6     7.06     4.7 
## 10    10 Duck… NES      1984  Shoo… Nintendo      26.9     0.63     0.28
## # … with 16,588 more rows, and 2 more variables: Other_Sales &lt;dbl&gt;,
## #   Global_Sales &lt;dbl&gt;</code></pre>
<p>Except now we have a new entry <code>Groups:</code>. This tells us that the dataset has been grouped and by what variables. This means that any subsequent summarisation we do will be done against those groups.</p>
<p>To test whether a dataset has been grouped, you can use the <code>dplyr::is_grouped_df()</code>, and to ungroup a dataset, just use <code>dplyr::ungroup()</code>:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="mutation-new-columns.html#cb59-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">is_grouped_df</span>(grpd_vg_sales)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="mutation-new-columns.html#cb61-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">is_grouped_df</span>(vg_sales)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="mutation-new-columns.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dplyr<span class="sc">::</span><span class="fu">ungroup</span>(grpd_vg_sales), <span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 16,598 x 11
##    Rank Name  Platform Year  Genre Publisher NA_Sales EU_Sales JP_Sales
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1     1 Wii … Wii      2006  Spor… Nintendo      41.5    29.0      3.77
## 2     2 Supe… NES      1985  Plat… Nintendo      29.1     3.58     6.81
## 3     3 Mari… Wii      2008  Raci… Nintendo      15.8    12.9      3.79
## 4     4 Wii … Wii      2009  Spor… Nintendo      15.8    11.0      3.28
## 5     5 Poke… GB       1996  Role… Nintendo      11.3     8.89    10.2 
## # … with 16,593 more rows, and 2 more variables: Other_Sales &lt;dbl&gt;,
## #   Global_Sales &lt;dbl&gt;</code></pre>
<p>Now that our dataset is grouped, our <code>mutate()</code> call will be evaluated for each permutation of the provided groups. Let’s look at an example of creating a cumulative sum for each Publisher:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="mutation-new-columns.html#cb65-1" aria-hidden="true" tabindex="-1"></a>vg_sales <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="mutation-new-columns.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Publisher) <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="mutation-new-columns.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">as.numeric</span>(Year)) <span class="sc">%&gt;%</span> <span class="co"># We need to order from earliest date to latest</span></span>
<span id="cb65-4"><a href="mutation-new-columns.html#cb65-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Cumulative_Sales =</span> <span class="fu">cumsum</span>(Global_Sales)) <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="mutation-new-columns.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Publisher <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Atari&quot;</span>, <span class="st">&quot;Activision&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># Let&#39;s just look at Atari &amp; Activision</span></span>
<span id="cb65-6"><a href="mutation-new-columns.html#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## Warning: Problem with `mutate()` input `^^--arrange_quosure_1`.
## ℹ NAs introduced by coercion
## ℹ Input `^^--arrange_quosure_1` is `as.numeric(Year)`.</code></pre>
<pre><code>## Warning in mask$eval_all_mutate(dots[[i]]): NAs introduced by coercion</code></pre>
<pre><code>## # A tibble: 1,338 x 12
## # Groups:   Publisher [2]
##    Rank Name  Platform Year  Genre Publisher NA_Sales EU_Sales JP_Sales
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1   259 Aste… 2600     1980  Shoo… Atari         4        0.26        0
## 2   545 Miss… 2600     1980  Shoo… Atari         2.56     0.17        0
## 3  1768 Kabo… 2600     1980  Misc  Activisi…     1.07     0.07        0
## 4  1971 Defe… 2600     1980  Misc  Atari         0.99     0.05        0
## 5  2671 Boxi… 2600     1980  Figh… Activisi…     0.72     0.04        0
## # … with 1,333 more rows, and 3 more variables: Other_Sales &lt;dbl&gt;,
## #   Global_Sales &lt;dbl&gt;, Cumulative_Sales &lt;dbl&gt;</code></pre>
<p>Now we’ve got a new column showing the total number of sales for each Publisher up to each year. What <code>{dplyr}</code> has done is essentially filtered the data down a specific publisher, created a cumulative sum of the <code>Global_Sales</code> column, and then done that for each publisher and stitched it back together.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pivoting-columns.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summarisation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
